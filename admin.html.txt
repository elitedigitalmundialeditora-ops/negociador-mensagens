<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Painel Admin - Negociador</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="firebase.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<h2>Painel Administrativo - Negociador</h2>

<table>
    <thead>
        <tr>
            <th>Setor</th>
            <th>Atraso (%)</th>
            <th>Junção (%)</th>
            <th>Quitação (%)</th>
            <th>Ação</th>
        </tr>
    </thead>
    <tbody id="tabelaConfig"></tbody>
</table>

<script>
const setores = ["play1", "play2", "play3", "play6"];

async function carregarConfigs() {
    const tbody = document.getElementById("tabelaConfig");
    tbody.innerHTML = "";
    for (let setor of setores) {
        const doc = await db.collection("config").doc(setor).get();
        if (doc.exists) {
            const cfg = doc.data();
            const tr = document.createElement("tr");
            tr.innerHTML = `
                <td>${setor}</td>
                <td><input type="number" id="${setor}-atraso" value="${cfg.atraso || 0}"></td>
                <td><input type="number" id="${setor}-juncao" value="${cfg.juncao || 0}"></td>
                <td><input type="number" id="${setor}-quitacao" value="${cfg.quitacao || 0}"></td>
                <td><button onclick="salvar('${setor}')">Salvar</button></td>
            `;
            tbody.appendChild(tr);
        }
    }
}

async function salvar(setor) {
    const atraso = parseFloat(document.getElementById(`${setor}-atraso`).value) || 0;
    const juncao = parseFloat(document.getElementById(`${setor}-juncao`).value) || 0;
    const quitacao = parseFloat(document.getElementById(`${setor}-quitacao`).value) || 0;

    await db.collection("config").doc(setor).set({
        atraso, juncao, quitacao
    }, { merge: true });

    alert(`Configurações de ${setor} atualizadas com sucesso!`);
}

window.onload = carregarConfigs;
</script>

</body>
</html>
